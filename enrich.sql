with
geocity as(
    select
        geoid, geoname as city,
        case
            when (loweR(geoname) = 'albany' and state = 'OR') then 'Benton'
            when (lower(geoname) = 'madras' and state = 'OR') then 'Jefferson'
            when (lower(geoname) = 'salem' and state = 'OR') then 'Marion'
            else replace(countyname, ' County', '')
        end as county,
        state
    from lkp_geoid
    where state in('OR','WA','ID','MT') and geolevel = 'City'
),

hhdemo as (
select
    g.geoid,
    -- h.CITY, h.STATE,
    ifnull(h.DWELLINGTYPE, 'Other') as DWELLINGTYPE,
    h.HOUSEHOLDRANK,
    h.NUMBEROFADULTS::int as numadults,
    ifnull(h.YOUNGADULTINHOUSEHOLD, 'FALSE') as YOUNGADULTINHOUSEHOLD ,
    ifnull(h.SENIORADULTINHOUSEHOLD, 'FALSE') as SENIORADULTINHOUSEHOLD,
    h.GENERATIONSINHOUSEHOLD,
    ifnull(h.MARITALSTATUS, 'OTHER') as maritalstatus,
    ifnull(h.SINGLEPARENT, 'FALSE') as SINGLEPARENT,
    ifnull(h.CHILDRENPRESENT, 'NO') as CHILDRENPRESENT,
    ifnull(h.CHILDNEARHIGHSCHOOLGRADUATION, 'NO') as CHILDNEARHIGHSCHOOLGRADUATION,
    ifnull(h.COLLEGEGRADUATE, 'FALSE') as COLLEGEGRADUATE,
    replace(ifnull(h.CHRISTIANFAMILIES, 'FALSE'), 'TRURE', 'TRUE') as CHRISTIANFAMILIES,
    ifnull(h.BUSINESSOWNER, 'NO') as BUSINESSOWNER,
    ifnull(h.SOHO, 'NO') as SOHO,
    ifnull(h.WORKINGWOMAN, 'NO') as WORKINGWOMAN,
    ifnull(h.VETERANPRESENTINHOUSEHOLD, 'NO') as VETERANPRESENTINHOUSEHOLD,
    ifnull(h.CREDITCARDUSER, 'NO') as CREDITCARDUSER,
    ifnull(h.MAILORDERDONOR, 'NO') as MAILORDERDONOR,
    ifnull(h.MAILORDERBUYER, 'NO') as MAILORDERBUYER,
    ifnull(h.MAILORDERRESPONDER, 'NO') as MAILORDERRESPONDER,
    ifnull(h.TVSATELLITEDISH, 'NO') as TVSATELLITEDISH,
    ifnull(h.PETOWNER, 'NO') as PETOWNER,
    ifnull(h.CATOWNER, 'NO') as CATOWNER,
    ifnull(h.DOGOWNER, 'NO') as DOGOWNER,
    ifnull(h.OTHERPETOWNER, 'NO') as OTHERPETOWNER,
    ifnull(h.NEWTEENDRIVER, 'NO') as NEWTEENDRIVER,
    ifnull(h.NEWTEENDRIVERGENDER, 'NO') as NEWTEENDRIVERGENDER,
    ifnull(h.BOATOWNER, 'NO') as BOATOWNER,
    ifnull(h.TRUCKOWNER, 'NO') as TRUCKOWNER,
    ifnull(h.MOTORCYCLEOWNER, 'NO') as MOTORCYCLEOWNER,
    ifnull(h.RVOWNER, 'NO') as RVOWNER,
    ifnull(h.AUTOBUYNEW, 'NO') as AUTOBUYNEW,
    ifnull(h.AUTOBUYUSED, 'NO') as AUTOBUYUSED,
    ifnull(h.AUTOBUYUSED5MONTHSORLESS, 'NO') as AUTOBUYUSED5MONTHSORLESS,
    ifnull(h.AUTOBUYUSED6MONTHSORMORE, 'NO') as AUTOBUYUSED6MONTHSORMORE,
    h.NETWORTH::int as networth,
    h.NETWORTHRANGE,
    ifnull(h.MILLIONAIRE, 'NO') as MILLIONAIRE,
    h.UNSECUREDCREDITCAPACITY::int unsecuredcreditcapacity,
    h.UNSECUREDCREDITCAPACITYRANGE,
    h.DISCRETIONARYINCOME::int as discincome,
    h.DISCRETIONARYINCOMERANGE,
    h.DONORCAPACITY::int as donorcapacity,
    h.DONORCAPACITYRANGE,
    ifnull(h.INVESTMENTPROPERTIESOWNED, 0) as INVESTMENTPROPERTIESOWNED,
    ifnull(h.ESTIMATEDAREACREDITRATING, 'UNKNOWN') as estcreditrating,
    h.HOMEVALUE::int as homevalue,
    h.HOMEVALUERANGE,
    h.MEDIANHOMEVALUE::int as medhomevalue,
    h.MEDIANHOMEVALUERANGE,
    ifnull(h.RECENTHOMEBUYER, 'NO') as RECENTHOMEBUYER,
    ifnull(h.RECENTMORTGAGEBORROWER, 'NO') as RECENTMORTGAGEBORROWER,
    ifnull(h.NEWHOMEOWNERFLAG, 'FALSE') as NEWHOMEOWNERFLAG,
    ifnull(h.MOSTRECENTHOMEPURCHASEDATEFLAG, 'FALSE') as MOSTRECENTHOMEPURCHASEDATEFLAG,
    ifnull(h.HOMEASSESSEDVALUE, 'UNKNOWN') as homeassessedvalue,
    ifnull(h.DONORCHARITABLE, 'FALSE') as DONORCHARITABLE,
    ifnull(h.DONORANIMALWELFARE, 'FALSE') as DONORANIMALWELFARE,
    ifnull(h.DONORARTSCULTURAL, 'FALSE') as DONORARTSCULTURAL,
    ifnull(h.DONORCHILDRENS, 'FALSE') as DONORCHILDRENS,
    ifnull(h.DONORENVIRONMENTWILDLIFE, 'FALSE') as DONORENVIRONMENTWILDLIFE,
    ifnull(h.DONORHEALTH, 'FALSE') as DONORHEALTH,
    ifnull(h.DONORINTERNATIONALAID, 'FALSE') as DONORINTERNATIONALAID,
    ifnull(h.DONORPOLITICAL, 'FALSE') as DONORPOLITICAL,
    ifnull(h.DONORPOLITICALCONSERVATIVE, 'FALSE') as DONORPOLITICALCONSERVATIVE,
    ifnull(h.DONORPOLITICALLIBERAL, 'FALSE') as DONORPOLITICALLIBERAL,
    ifnull(h.DONORRELIGIOUS, 'FALSE') as DONORRELIGIOUS,
    ifnull(h.DONORVETERANS, 'FALSE') as DONORVETERANS,
    ifnull(h.CCAMERICANEXPRESS, 'FALSE') as CCAMERICANEXPRESS,
    ifnull(h.CCAMERICANEXPRESSGOLDPLATINUM, 'FALSE') as CCAMERICANEXPRESSGOLDPLATINUM,
    ifnull(h.CCDISCOVER, 'FALSE') as CCDISCOVER,
    ifnull(h.CCVISA, 'FALSE') as CCVISA,
    ifnull(h.CCMASTERCARD, 'FALSE') as CCMASTERCARD,
    ifnull(h.CCBANK, 'FALSE') as CCBANK,
    ifnull(h.CCGASDEPTRETAIL, 'FALSE') as CCGASDEPTRETAIL,
    ifnull(h.CCTRAVELENTERTAINMENT, 'FALSE') as CCTRAVELENTERTAINMENT,
    ifnull(h.CCUNKNOWN, 'FALSE') as CCUNKNOWN,
    ifnull(h.CCGOLDPLATINUM, 'FALSE') as CCGOLDPLATINUM,
    ifnull(h.CCPREMIUM, 'FALSE') as CCPREMIUM,
    ifnull(h.CCUPSCALEDEPT, 'FALSE') as CCUPSCALEDEPT,
    ifnull(h.CCNEWISSUE, 'FALSE') as CCNEWISSUE,
    ifnull(h.HOMELIVING, 'FALSE') as HOMELIVING,
    ifnull(h.DIYLIVING, 'FALSE') as DIYLIVING,
    ifnull(h.SPORTYLIVING, 'FALSE') as SPORTYLIVING,
    ifnull(h.UPSCALELIVING, 'FALSE') as UPSCALELIVING,
    ifnull(h.CULTURALARTISTICLIVING, 'FALSE') as CULTURALARTISTICLIVING,
    ifnull(h.HIGHBROW, 'FALSE') as HIGHBROW,
    ifnull(h.COMMONLIVING, 'FALSE') as COMMONLIVING,
    ifnull(h.PROFESSIONALLIVING, 'FALSE') as PROFESSIONALLIVING,
    ifnull(h.BROADERLIVING, 'FALSE') as BROADERLIVING,
    ifnull(h.ARTS, 'FALSE') as ARTS,
    ifnull(h.THEATERPERFORMINGARTS, 'FALSE') as THEATERPERFORMINGARTS,
    ifnull(h.FOODWINES, 'FALSE') as FOODWINES,
    ifnull(h.FOODSNATURAL, 'FALSE') as FOODSNATURAL,
    ifnull(h.COOKINGGENERAL, 'FALSE') as COOKINGGENERAL,
    ifnull(h.COOKINGGOURMET, 'FALSE') as COOKINGGOURMET,
    ifnull(h.AVIATION, 'FALSE') as AVIATION,
    ifnull(h.AUTOWORK, 'FALSE') as AUTOWORK,
    ifnull(h.AUTOMOTIVEBUFF, 'FALSE') as AUTOMOTIVEBUFF,
    ifnull(h.BEAUTYCOSMETICS, 'FALSE') as BEAUTYCOSMETICS,
    ifnull(h.CAREER, 'FALSE') as CAREER,
    ifnull(h.CAREERIMPROVEMENT, 'FALSE') as CAREERIMPROVEMENT,
    ifnull(h.PARENTING, 'FALSE') as PARENTING,
    ifnull(h.CHILDRENSINTERESTS, 'FALSE') as CHILDRENSINTERESTS,
    ifnull(h.GRANDCHILDREN, 'FALSE') as GRANDCHILDREN,
    ifnull(h.COMMUNITYCHARITIES, 'FALSE') as COMMUNITYCHARITIES,
    ifnull(h.RELIGIOUSINSPIRATIONAL, 'FALSE') as RELIGIOUSINSPIRATIONAL,
    ifnull(h.CRAFTS, 'FALSE') as CRAFTS,
    ifnull(h.PHOTOGRAPHY, 'FALSE') as PHOTOGRAPHY,
    ifnull(h.SEWINGKNITTINGNEEDLEWORK, 'FALSE') as SEWINGKNITTINGNEEDLEWORK,
    ifnull(h.COLLECTORAVID, 'FALSE') as COLLECTORAVID,
    ifnull(h.COLLECTIBLESGROUPING, 'FALSE') as COLLECTIBLESGROUPING,
    ifnull(h.COLLECTIBLESGENERAL, 'FALSE') as COLLECTIBLESGENERAL,
    ifnull(h.COLLECTIBLESSTAMPS, 'FALSE') as COLLECTIBLESSTAMPS,
    ifnull(h.COLLECTIBLESCOINS, 'FALSE') as COLLECTIBLESCOINS,
    ifnull(h.COLLECTIBLESARTS, 'FALSE') as COLLECTIBLESARTS,
    ifnull(h.COLLECTIBLESANTIQUES, 'FALSE') as COLLECTIBLESANTIQUES,
    ifnull(h.COLLECTIBLESSPORTSMEMORABILIA, 'FALSE') as COLLECTIBLESSPORTSMEMORABILIA,
    ifnull(h.EDUCATIONONLINE, 'FALSE') as EDUCATIONONLINE,
    ifnull(h.EXERCISEAEROBIC, 'FALSE') as EXERCISEAEROBIC,
    ifnull(h.EXERCISERUNNINGJOGGING, 'FALSE') as EXERCISERUNNINGJOGGING,
    ifnull(h.EXERCISEWALKING, 'FALSE') as EXERCISEWALKING,
    ifnull(h.HIGHTECHGENERAL, 'FALSE') as HIGHTECHGENERAL,
    ifnull(h.GAMESCOMPUTERGAMES, 'FALSE') as GAMESCOMPUTERGAMES,
    ifnull(h.GAMESVIDEOGAMES, 'FALSE') as GAMESVIDEOGAMES,
    ifnull(h.GAMESBOARDPUZZLES, 'FALSE') as GAMESBOARDPUZZLES,
    ifnull(h.GAMINGCASINO, 'FALSE') as GAMINGCASINO,
    ifnull(h.CONSUMERELECTRONICS, 'FALSE') as CONSUMERELECTRONICS,
    ifnull(h.ENVIRONMENTALISSUES, 'FALSE') as ENVIRONMENTALISSUES,
    ifnull(h.GARDENING, 'FALSE') as GARDENING,
    ifnull(h.HOMEFURNISHINGSDECORATING, 'FALSE') as HOMEFURNISHINGSDECORATING,
    ifnull(h.HOUSEPLANT, 'FALSE') as HOUSEPLANT,
    ifnull(h.HOMEIMPROVEMENTGROUPING, 'FALSE') as HOMEIMPROVEMENTGROUPING,
    ifnull(h.HOMEIMPROVEMENT, 'FALSE') as HOMEIMPROVEMENT,
    ifnull(h.HOMEIMPROVEMENTDIY, 'FALSE') as HOMEIMPROVEMENTDIY,
    ifnull(h.HEALTHMEDICAL, 'FALSE') as HEALTHMEDICAL,
    ifnull(h.DIETINGWEIGHTLOSS, 'FALSE') as DIETINGWEIGHTLOSS,
    ifnull(h.SELFIMPROVEMENT, 'FALSE') as SELFIMPROVEMENT,
    ifnull(h.INVESTMENTSGROUPING, 'FALSE') as INVESTMENTSGROUPING,
    ifnull(h.INVESTMENTSFOREIGN, 'FALSE') as INVESTMENTSFOREIGN,
    ifnull(h.INVESTMENTSPERSONAL, 'FALSE') as INVESTMENTSPERSONAL,
    ifnull(h.INVESTMENTSREALESTATE, 'FALSE') as INVESTMENTSREALESTATE,
    ifnull(h.INVESTMENTSSTOCKSBONDS, 'FALSE') as INVESTMENTSSTOCKSBONDS,
    ifnull(h.MONEYSEEKERS, 'FALSE') as MONEYSEEKERS,
    ifnull(h.SWEEPSTAKESCONTESTS, 'FALSE') as SWEEPSTAKESCONTESTS,
    ifnull(h.MUSICHOMESTEREO, 'FALSE') as MUSICHOMESTEREO,
    ifnull(h.MUSICPLAYER, 'FALSE') as MUSICPLAYER,
    ifnull(h.MUSICCOLLECTOR, 'FALSE') as MUSICCOLLECTOR,
    ifnull(h.MUSICLISTENER, 'FALSE') as MUSICLISTENER,
    ifnull(h.MOVIEGROUPING, 'FALSE') as MOVIEGROUPING,
    ifnull(h.MOVIEMUSICGENERAL, 'FALSE') as MOVIEMUSICGENERAL,
    ifnull(h.MOVIECOLLECTOR, 'FALSE') as MOVIECOLLECTOR,
    ifnull(h.READINGGENERAL, 'FALSE') as READINGGENERAL,
    ifnull(h.READINGAUDIOBOOKS, 'FALSE') as READINGAUDIOBOOKS,
    ifnull(h.READINGMAGAZINES, 'FALSE') as READINGMAGAZINES,
    ifnull(h.READINGRELIGIOUSINSPIRATIONAL, 'FALSE') as READINGRELIGIOUSINSPIRATIONAL,
    ifnull(h.READINGSCIENCEFICTION, 'FALSE') as READINGSCIENCEFICTION,
    ifnull(h.READINGFINANCIALNEWSLETTERSUBSCRIBERS, 'FALSE') as READINGFINANCIALNEWSLETTERSUBSCRIBERS,
    ifnull(h.CURRENTAFFAIRSPOLITICS, 'FALSE') as CURRENTAFFAIRSPOLITICS,
    ifnull(h.HISTORYMILITARY, 'FALSE') as HISTORYMILITARY,
    ifnull(h.OUTDOORGROUPING, 'FALSE') as OUTDOORGROUPING,
    ifnull(h.OUTDOORENTHUSIASTGENERAL, 'FALSE') as OUTDOORENTHUSIASTGENERAL,
    ifnull(h.OUTDOORFISHING, 'FALSE') as OUTDOORFISHING,
    ifnull(h.OUTDOORBOATINGSAILING, 'FALSE') as OUTDOORBOATINGSAILING,
    ifnull(h.OUTDOORCAMPINGHIKING, 'FALSE') as OUTDOORCAMPINGHIKING,
    ifnull(h.OUTDOORHUNTINGSHOOTING, 'FALSE') as OUTDOORHUNTINGSHOOTING,
    ifnull(h.OUTDOORSCUBADIVING, 'FALSE') as OUTDOORSCUBADIVING,
    ifnull(h.SPECTATORSPORTSGROUPING, 'FALSE') as SPECTATORSPORTSGROUPING,
    ifnull(h.SPECTATORSPORTSGENERAL, 'FALSE') as SPECTATORSPORTSGENERAL,
    ifnull(h.SPECTATORSPORTSBASEBALL, 'FALSE') as SPECTATORSPORTSBASEBALL,
    ifnull(h.SPECTATORSPORTSBASKETBALL, 'FALSE') as SPECTATORSPORTSBASKETBALL,
    ifnull(h.SPECTATORSPORTSFOOTBALL, 'FALSE') as SPECTATORSPORTSFOOTBALL,
    ifnull(h.SPECTATORSPORTSHOCKEY, 'FALSE') as SPECTATORSPORTSHOCKEY,
    ifnull(h.SPECTATORSPORTSRACING, 'FALSE') as SPECTATORSPORTSRACING,
    ifnull(h.SPECTATORSPORTSSOCCER, 'FALSE') as SPECTATORSPORTSSOCCER,
    ifnull(h.SPECTATORSPORTSTVSPORTS, 'FALSE') as SPECTATORSPORTSTVSPORTS,
    ifnull(h.SPECTATORNASCAR, 'FALSE') as SPECTATORNASCAR,
    ifnull(h.SMOKINGTOBACCO, 'FALSE') as SMOKINGTOBACCO,
    ifnull(h.SPORTSGROUPING, 'FALSE') as SPORTSGROUPING,
    ifnull(h.SPORTSEQUESTRIAN, 'FALSE') as SPORTSEQUESTRIAN,
    ifnull(h.SPORTSGOLF, 'FALSE') as SPORTSGOLF,
    ifnull(h.SPORTSMOTORCYCLING, 'FALSE') as SPORTSMOTORCYCLING,
    ifnull(h.SPORTSSKIING, 'FALSE') as SPORTSSKIING,
    ifnull(h.SPORTSTENNIS, 'FALSE') as SPORTSTENNIS,
    ifnull(h.TRAVELGROUPING, 'FALSE') as TRAVELGROUPING,
    ifnull(h.TRAVELCRUISES, 'FALSE') as TRAVELCRUISES,
    ifnull(h.TRAVELDOMESTIC, 'FALSE') as TRAVELDOMESTIC,
    ifnull(h.TRAVELINTERNATIONAL, 'FALSE') as TRAVELINTERNATIONAL,
    ifnull(h.TRAVELRV, 'FALSE') as TRAVELRV,
    ifnull(h.SCIENCESPACE, 'FALSE') as SCIENCESPACE,
    ifnull(h.WOODWORKING, 'FALSE') as WOODWORKING,
    ifnull(h.BUYERBOOKS, 'FALSE') as BUYERBOOKS,
    ifnull(h.BUYERCRAFTSHOBBIES, 'FALSE') as BUYERCRAFTSHOBBIES,
    ifnull(h.BUYERGARDENINGFARMING, 'FALSE') as BUYERGARDENINGFARMING,
    ifnull(h.BUYERJEWELRY, 'FALSE') as BUYERJEWELRY,
    ifnull(h.BUYERLUGGAGE, 'FALSE') as BUYERLUGGAGE,
    ifnull(h.BUYERONLINE, 'FALSE') as BUYERONLINE,
    ifnull(h.BUYERMEMBERSHIPCLUB, 'FALSE') as BUYERMEMBERSHIPCLUB,
    ifnull(h.BUYERMERCHANDISEMALE, 'FALSE') as BUYERMERCHANDISEMALE,
    ifnull(h.BUYERMERCHANDISEFEMALE, 'FALSE') as BUYERMERCHANDISEFEMALE,
    ifnull(h.BUYERHEALTHBEAUTY, 'FALSE') as BUYERHEALTHBEAUTY,
    ifnull(h.BUYERCHILDRENSBABYCARE, 'FALSE') as BUYERCHILDRENSBABYCARE,
    ifnull(h.BUYERCHILDRENSLEARNINGTOYS, 'FALSE') as BUYERCHILDRENSLEARNINGTOYS,
    ifnull(h.BUYERCHILDRENSBACKTOSCHOOL, 'FALSE') as BUYERCHILDRENSBACKTOSCHOOL,
    ifnull(h.APPARELCHILDRENS, 'FALSE') as APPARELCHILDRENS,
    ifnull(h.APPARELINFANTTODDLERS, 'FALSE') as APPARELINFANTTODDLERS,
    ifnull(h.APPARELWOMENS, 'FALSE') as APPARELWOMENS,
    ifnull(h.APPARELWOMENSPETITE, 'FALSE') as APPARELWOMENSPETITE,
    ifnull(h.APPARELWOMENSPLUSSIZE, 'FALSE') as APPARELWOMENSPLUSSIZE,
    ifnull(h.APPARELWOMENSYOUNG, 'FALSE') as APPARELWOMENSYOUNG,
    ifnull(h.APPARELMENS, 'FALSE') as APPARELMENS,
    ifnull(h.APPARELMENSBIGTALL, 'FALSE') as APPARELMENSBIGTALL,
    ifnull(h.APPARELMENSYOUNG, 'FALSE') as APPARELMENSYOUNG,
    ifnull(h.AUTOPARTSACCESSORIES, 'FALSE') as AUTOPARTSACCESSORIES,
    ifnull(h.MILITARYMEMORABILIAWEAPONS, 'FALSE') as MILITARYMEMORABILIAWEAPONS,
    ifnull(h.MUSICALINSTRUMENTS, 'FALSE') as MUSICALINSTRUMENTS,
    ifnull(h.PHOTOGRAPHYVIDEOEQUIPMENT, 'FALSE') as PHOTOGRAPHYVIDEOEQUIPMENT,
    ifnull(h.SPORTSLEISURE, 'FALSE') as SPORTSLEISURE,
    ifnull(h.VALUEHUNTER, 'FALSE') as VALUEHUNTER
from geocity g
join hh_bronze.c1.householddemographic h ON lower(g.city) = lower(h.city) AND g.state = h.state
where g.geoid in(
'4101000',
'1603700',
'4103800',
'4105800',
'5305560',
'1608830',
'1612250',
'5311615',
'5311825',
'4115950',
'4117300',
'5317320',
'5321240',
'1625570',
'4123850',
'4126050',
'4130550',
'4132550',
'4133700',
'1638620',
'4138000',
'5335275',
'1644290',
'4141050',
'4141650',
'4142600',
'4144050',
'4145250',
'5342835',
'4147000',
'1651850',
'1652660',
'4149450',
'5347245',
'1654730',
'1656260',
'1656980',
'1660940',
'4157450',
'1664810',
'4159850',
'5356450',
'1666340',
'4161200',
'4164900',
'1672100',
'4167950',
'1676060',
'5367000',
'4169600',
'4171650',
'4171950',
'4172800',
'4172950',
'4177050',
'4178000',
'5375775',
'5376405',
'5377105',
'5378330',
'5380010'
)
)

select * from geocity g
left join hhdemo using(geoid)